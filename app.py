import pandas as pd
import streamlit as st
import matplotlib.pyplot as plt
#--------------------------------------------------------------------------------------#
# Load CSV with caching and loading spinner
@st.cache_data
def load_data():
    return pd.read_csv("https://raw.githubusercontent.com/arkarpro/titanic-eda-dashboard/main/Titanic.csv")

with st.spinner("ğŸ”„ Loading data... Please wait."):
    df = load_data()
#--------------------------------------------------------------------------------------#
# Dashboard Title
st.markdown(
    "<h1 style='color:blue; font-size: 36px; text-align: left;'>Titanic EDA Dashboard</h1>", 
    unsafe_allow_html=True
)
st.info("Titanic EDA Dashboard á€á€Šá€º á€á€„á€ºá€€á€¼á€¬á€¸á€™á€¾á€¯á€†á€­á€¯á€„á€ºá€›á€¬ á€¡á€œá€­á€¯á€€á€º á€œá€±á€·á€€á€»á€„á€ºá€·á€á€±á€¬á€–á€­á€¯á€„á€ºá€–á€¼á€…á€ºá€•á€«á€á€–á€¼á€„á€ºá€· á€¡á€á€¼á€±á€á€¶á€á€„á€ºá€€á€¼á€¬á€¸á€™á€¾á€¯á€™á€»á€¬á€¸á€€á€­á€¯ á€œá€±á€·á€œá€¬á€á€„á€ºá€€á€¼á€¬á€¸á€á€¼á€„á€ºá€¸á€€á€­á€¯ á€œá€€á€ºá€á€½á€±á€·á€™á€»á€¾á€á€±á€á€±á€¬ á€œá€±á€·á€€á€»á€„á€ºá€·á€á€”á€ºá€¸á€á€…á€ºá€á€¯á€á€¬á€–á€¼á€…á€ºá€•á€«á€á€Šá€ºá‹")
st.markdown("""
    - **á€šá€á€¯á€œá€±á€·á€€á€»á€„á€·á€ºá€á€”á€ºá€¸á€™á€¾á€¬** á€á€›á€®á€¸á€á€Šá€ºá€™á€»á€¬á€¸á *á€¡á€™á€»á€­á€¯á€¸á€¡á€…á€¬á€¸*áŠ *á€¡á€á€€á€ºá€¡á€¯á€•á€ºá€…á€¯* á€”á€¾á€„á€·á€º *á€¡á€á€€á€ºá€›á€¾á€„á€º/á€á€±á€†á€¯á€¶á€¸á€™á€¾á€¯* á€¡á€á€¼á€±á€¡á€”á€±á€™á€»á€¬á€¸á€€á€­á€¯ á€á€¯á€¶á€¸á€á€•á€ºá€á€½á€¬á€¸á€™á€¾á€¬ á€–á€¼á€…á€ºá€•á€«á€á€šá€ºá‹
    - **á€™á€¾á€á€ºá€á€»á€€á€ºá‹ á‹** á€šá€á€¯á€œá€±á€·á€€á€»á€„á€ºá€·á€á€”á€ºá€¸á€€á€­á€¯ á€á€„á€ºá€€á€¼á€¬á€¸á€™á€¾á€¯ á€¡á€á€”á€ºá€¸á€¡á€œá€­á€¯á€€á€º á€á€†á€„á€ºá€·á€…á€® update á€•á€¼á€¯á€œá€¯á€•á€ºá€á€½á€¬á€¸á€™á€Šá€ºá€–á€¼á€…á€ºá€•á€«á€á€Šá€ºá‹
""")

st.info("Titanic á€á€„á€ºá€¹á€˜á€±á€¬á€€á€¼á€®á€¸ á€á€›á€®á€¸á€á€Šá€ºá€¡á€á€»á€€á€ºá€¡á€œá€€á€ºá€™á€»á€¬á€¸")
st.markdown("""
    - á€á€›á€®á€¸á€á€Šá€º á€…á€¯á€…á€¯á€•á€±á€«á€„á€ºá€¸ **áˆá‰á** á€¦á€¸ á€•á€«á€á€„á€ºá€á€Šá€ºá‹
    - **á€¡á€™á€»á€­á€¯á€¸á€á€¬á€¸ á…á‡á‡** á€¦á€¸á€”á€¾á€„á€·á€º **á€¡á€™á€»á€­á€¯á€¸á€á€™á€®á€¸ áƒáá„** á€¦á€¸ á€•á€«á€á€„á€ºá€á€Šá€ºá‹
    - á€šá€á€¯á€œá€±á€·á€€á€»á€„á€·á€ºá€á€”á€ºá€¸á€á€½á€„á€ºáŠ 
        - á€¡á€á€€á€ºá€¡á€¯á€•á€ºá€…á€¯
        - á€…á€®á€¸á€”á€„á€ºá€¸á€œá€­á€¯á€€á€ºá€•á€«á€œá€¬á€á€Šá€ºá€· á€¡á€á€”á€ºá€¸ (P class)
        - á€€á€»á€¬á€¸/á€™
        - á€›á€¾á€„á€ºá€á€”á€º/á€á€±á€†á€¯á€¶á€¸á€™á€¾á€¯á€™á€»á€¬á€¸
    á€€á€­á€¯ á€…á€¯á€…á€Šá€ºá€¸á€á€¯á€¶á€¸á€á€•á€ºá€á€½á€¬á€¸á€€á€¼á€™á€¾á€¬ á€–á€¼á€…á€ºá€•á€«á€á€šá€ºá‹
""")

#--------------------------------------------------------------------------------------#
# add one blank line here
st.text("")  # Blank line
st.text("")  # Blank line
st.text("")  # Blank line
#--------------------------------------------------------------------------------------#
total_passengers_sex= df.Sex.value_counts() # prepare passenger table
st.markdown("#### Total Passengers by Gender") #show subtitle
st.markdown("""
    ##### ğŸ’¡ Idea  
    - á€á€›á€®á€¸á€á€½á€¬á€¸ á€¡á€™á€»á€­á€¯á€¸á€á€¬á€¸áŠ á€¡á€™á€»á€­á€¯á€¸á€á€™á€®á€¸ á€¡á€›á€±á€¡á€á€½á€€á€ºá€€á€­á€¯ á€¡á€á€»á€€á€ºá€¡á€œá€€á€ºá€¡á€¬á€¸á€–á€¼á€„á€ºá€· á€’á€±á€«á€„á€ºá€¸á€œá€¯á€á€ºá€á€»á€”á€­á€¯á€„á€ºá€›á€”á€º á€˜á€šá€ºá€˜á€€á€ºá€á€½á€„á€º á€‡á€šá€¬á€¸á€–á€¼á€„á€ºá€· á€–á€±á€¬á€ºá€•á€¼á€‘á€¬á€¸á€•á€¼á€®á€¸á€á€±á€¬á€·áŠ  
    - á€¡á€á€»á€€á€ºá€¡á€œá€€á€ºá€€á€­á€¯ á€¡á€œá€½á€šá€ºá€™á€¼á€„á€ºá€á€¬á€…á€±á€›á€”á€º á€Šá€¬á€˜á€€á€ºá€á€½á€„á€º Bar Chart á€–á€¼á€„á€ºá€·â€‹á€–á€±á€¬á€ºá€•á€¼á€€á€¼á€™á€šá€ºá‹
""")
st.text("")  # Blank line

col01, col02 = st.columns(2) # to defind columns
with col01:
    st.markdown("**Count of Passengers**") #show subtitle
    st.dataframe(total_passengers_sex, height=100, width=250) # Show Total Passengers
with col02: # Bar chart in right size
    st.markdown("**Bar Chart**")
    fig, ax = plt.subplots(figsize=(1, 1), dpi=200)  # High DPI for clarity
    ax.bar(total_passengers_sex.index, total_passengers_sex.values, color=["skyblue", "salmon"])
    ax.set_title("Total Passengers by Gender", fontsize=6)
    ax.set_xlabel("Gender", fontsize=5)
    ax.set_ylabel("Total", fontsize=5)
    ax.tick_params(axis='both', which='both', length=0, labelsize=4)
    ax.spines["top"].set_visible(False)     # á€¡á€•á€±á€«á€ºá€˜á€±á€¬á€„á€ºá€–á€»á€±á€¬á€€á€º
    ax.spines["right"].set_visible(False)   # á€Šá€¬á€˜á€±á€¬á€„á€ºá€–á€»á€±á€¬á€€á€º
    ax.spines["bottom"].set_visible(False)  # á€¡á€±á€¬á€€á€ºá€˜á€±á€¬á€„á€ºá€–á€»á€±á€¬á€€á€º
    ax.spines["left"].set_visible(False)    # á€˜á€šá€ºá€˜á€±á€¬á€„á€ºá€–á€»á€±á€¬á€€á€º
    st.pyplot(fig)        # Show in Streamlit
#--------------------------------------------------------------------------------------#
st.text("-------------------------------------------------------------------------------")  # add a line
st.text("")  # Blank line
st.text("")  # Blank line
#--------------------------------------------------------------------------------------#
survived_status = df['Survived'].value_counts() # Prepare data

# Subtitle
st.markdown("#### Survived and Not-Survived Passengers")
st.markdown("""
    ##### ğŸ’¡ Idea  
    - á€¡á€á€€á€ºá€›á€¾á€„á€ºá€á€”á€ºá€€á€»á€”á€ºá€›á€…á€ºá€á€° á€…á€¬á€›á€„á€ºá€¸á€€á€­á€¯ á€€á€»á€¬á€¸áŠá€™ á€¡á€œá€­á€¯á€€á€ºá€–á€±á€¬á€ºá€•á€¼á€á€¼á€„á€ºá€¸á€–á€¼á€„á€ºá€· á€¡á€œá€½á€šá€ºá€á€€á€°á€”á€¾á€­á€¯á€„á€ºá€¸á€šá€¾á€‰á€ºá€”á€­á€¯á€„á€ºá€”á€­á€¯á€„á€ºá€¡á€±á€¬á€„á€ºá€•á€¼á€„á€ºá€†á€„á€ºá€™á€šá€ºá‹ 
    - á€’á€®á€á€…á€ºá€á€« á€¡á€á€¼á€±á€á€¶ Pie chart á€œá€±á€¸á€€á€­á€¯ á€›á€­á€¯á€¸á€›á€¾á€„á€ºá€¸á€…á€½á€¬á€‘á€Šá€ºá€·á€™á€šá€ºá‹
""")
# Columns
col1, col2 = st.columns(2)
# Styled box (left side)
with col1:
    st.markdown("** Count Table**")
    st.dataframe(survived_status, height=100, width=250)  # small height, just enough for 2 rows
# Pie chart (right side)
with col2:
    st.markdown("** Pie Chart**")
    fig, ax = plt.subplots(figsize=(1.5, 1.5), dpi=200)  # Higher DPI for clear labels
    ax.pie(survived_status, labels=["Not-Survived", "Survived"], autopct="%0.2f%%", shadow=True,
           colors=["red", "green"], textprops={'fontsize': 6})  # Clearer pie labels
    st.pyplot(fig)
st.text("-------------------------------------------------------------------------------")  # add a line
#--------------------------------------------------------------------------------------#
st.markdown("#### Survived Passengers by Class and Gender")
st.info("á€¡á€á€€á€ºá€›á€¾á€„á€ºá€á€”á€ºá€€á€»á€”á€ºá€›á€…á€ºá€á€±á€¬ á€¡á€™á€»á€­á€¯á€¸á€á€¬á€¸áŠ á€¡á€™á€»á€­á€¯á€¸á€á€™á€®á€¸á€™á€»á€¬á€¸ P Class á€¡á€œá€­á€¯á€€á€º Bar Chart á€”á€²á€· á€–á€”á€ºá€á€®á€¸á€€á€¼á€Šá€ºá€·á€€á€¼á€™á€šá€º")
st.markdown("""
    ##### ğŸ’¡ Idea  
    -  á€¡á€á€€á€ºá€›á€¾á€„á€ºá€á€±á€¬ á€¡á€™á€»á€­á€¯á€¸á€á€¬á€”á€¾á€„á€ºá€· á€¡á€™á€»á€­á€¯á€¸á€á€™á€®á€¸á€™á€»á€¬á€¸á€€á€­á€¯ á€¡á€œá€½á€šá€ºá€á€€á€° á€™á€¼á€„á€ºá€”á€­á€¯á€„á€ºá€…á€±á€›á€”á€ºá€”á€¾á€„á€ºá€·
    - P Class á€¡á€œá€­á€¯á€€á€º  Safety á€–á€¼á€…á€ºá€™á€¾á€¯á€á€Šá€º á€†á€€á€ºá€…á€•á€ºá€™á€¾á€¯á€›á€¾á€­á€”á€­á€¯á€„á€ºá€™á€œá€¬á€¸á€†á€­á€¯á€á€¬á€€á€­á€¯ á€…á€‰á€ºá€¸á€…á€¬á€¸á€”á€­á€¯á€„á€ºá€›á€”á€º á€€á€¼á€Šá€ºá€·á€€á€¼á€™á€šá€º
""")
st.info("á€¡á€›á€„á€ºá€†á€¯á€¶á€¸ á€€á€»á€¬á€¸áŠá€™ á€¡á€›á€±á€¡á€á€½á€€á€ºá€€á€­á€¯ P Class á€¡á€œá€­á€¯á€€á€º á€¡á€›á€„á€ºá€–á€±á€¬á€ºá€•á€¼á€‘á€¬á€¸á€™á€šá€º  á€’á€«á€™á€¾ á€¡á€±á€¬á€€á€ºá€™á€¾á€¬ á€–á€±á€¬á€ºá€•á€¼á€á€²á€· chart á€”á€²á€· á€”á€­á€¯á€„á€ºá€¸á€šá€¾á€‰á€ºá€•á€¼á€®á€¸ á€¡á€á€€á€ºá€›á€¾á€„á€ºá€á€° vs á€…á€¯á€…á€¯á€•á€±á€«á€„á€ºá€¸á€œá€­á€¯á€€á€ºá€•á€«á€œá€¬á€á€° á€•á€­á€¯á€™á€¼á€„á€ºá€á€­á€”á€­á€¯á€„á€ºá€™á€šá€ºá‹ ")
summary_sex_by_class = pd.crosstab(df["Pclass"],df["Sex"], margins = True) # crosstab á€€á€­á€¯á€á€¯á€¶á€¸á€™á€šá€º
st.markdown("**Count gender by Class**")
st.dataframe(summary_sex_by_class, width=800) #á€‡á€šá€¬á€¸á€–á€¼á€„á€ºá€·á€–á€±á€¬á€ºá€•á€¼á€›á€”á€º, á€‡á€šá€¬á€¸á€¡á€€á€»á€šá€ºá€€á€­á€¯ á€á€»á€­á€”á€ºá€Šá€¾á€­á€›á€”á€º

s_df = df[df["Survived"] == 1]  # á€¡á€á€€á€ºá€›á€¾á€„á€ºá€á€°á€™á€»á€¬á€¸á€€á€­á€¯ á€…á€…á€ºá€‘á€¯á€á€ºá€™á€šá€º
counts = s_df.groupby(["Pclass", "Sex"]).size().unstack() # Pclass á€”á€²á€· Sex á€¡á€œá€­á€¯á€€á€º á€›á€±á€á€½á€€á€ºá€™á€šá€º


fig, ax = plt.subplots() # Matplotlib á€”á€²á€·  count bar chart á€á€…á€ºá€á€¯á€›á€±á€¸
counts.plot(kind="bar", ax=ax)  # counts á€Ÿá€¬ DataFrame á€–á€¼á€…á€ºá€œá€­á€¯á€· direct bar plot á€”á€²á€·á€–á€±á€¬á€ºá€•á€¼á€œá€­á€¯á€·á€›á€á€šá€º

ax.set_title("Survived Passengers by Class and Gender") #title á€œá€±á€¸á€‘á€Šá€ºá€·á€™á€šá€º
ax.set_xlabel("Passenger Class")   # xlable á€œá€±á€¸á€‘á€Šá€ºá€·á€€á€¼á€Šá€ºá€·á€™á€šá€º
ax.set_ylabel("Count")             # ylable á€œá€±á€¸á€‘á€Šá€ºá€·á€™á€šá€º
ax.legend(title="Sex")             # á€¡á€Šá€½á€¾á€”á€ºá€¸á€œá€±á€¸á€á€•á€ºá€™á€šá€º

# Streamlit á€™á€¾á€¬ á€•á€¼
st.pyplot(fig)
st.text("-------------------------------------------------------------------------------")  # add a line
#--------------------------------------------------------------------------------------#
st.markdown("#### Age Distribution")
st.info("Historam  á€œá€±á€¸á€”á€²á€· á€á€›á€®á€¸á€á€Šá€ºá€™á€»á€¬á€¸á€›á€²á€· á€¡á€á€€á€ºá€€á€­á€¯ á€á€½á€²á€á€¼á€™á€ºá€¸á€…á€­á€á€ºá€–á€¼á€¬á€€á€¼á€Šá€ºá€·á€€á€¼á€™á€šá€º")
st.markdown("""
    ##### ğŸ’¡ Idea  
    -  á€á€›á€®á€¸á€á€Šá€ºá€™á€»á€¬á€¸á€›á€²á€· á€¡á€á€€á€ºá€™á€»á€¬á€¸á€€á€­á€¯ á€¡á€á€€á€ºá€¡á€¯á€•á€ºá€…á€¯á€á€½á€²á€•á€¼á€®á€¸ á€€á€¼á€Šá€ºá€·á€œá€­á€¯á€€á€ºá€™á€šá€ºá€†á€­á€¯á€›á€„á€º á€˜á€šá€ºá€¡á€›á€½á€šá€ºá€á€½á€±á€•á€­á€¯á€™á€»á€¬á€¸á€œá€²á€†á€­á€¯á€á€¬ chart á€™á€¾á€¬á€á€»á€€á€ºá€á€»á€„á€ºá€¸á€á€­á€”á€­á€¯á€„á€ºá€™á€šá€ºáŠ á€‚á€á€”á€ºá€¸á€á€½á€±á€–á€€á€ºá€›á€„á€º á€á€­á€–á€­á€¯á€·á€¡á€á€»á€­á€”á€ºá€•á€­á€¯á€šá€°á€›á€”á€­á€¯á€„á€ºá€á€šá€º
    -  Presentation á€™á€»á€¬á€¸á€œá€¯á€•á€ºá€á€²á€·á€¡á€á€« á€á€°á€·á€€á€­á€¯ á€¡á€›á€„á€ºá€‘á€¬á€¸á€•á€¼á€®á€¸áŠá€™á€­á€á€ºá€†á€€á€ºá€•á€«áŠ á€œá€±á€·á€€á€»á€„á€ºá€·á€á€”á€ºá€¸á€™á€¾á€¬á€á€±á€¬á€· á€’á€«á€€á€­á€¯á€–á€”á€ºá€á€®á€¸á€›á€á€¬ á€…á€‰á€ºá€¸á€…á€¬á€¸á€…á€›á€¬á€™á€»á€¬á€¸á€á€±á€¬á€· á€¡á€œá€±á€·á€¡á€€á€»á€„á€ºá€·á€›á€œá€¬á€™á€¾ á€œá€¯á€•á€ºá€–á€¼á€…á€ºá€á€¬á€•á€­á€¯á€€á€±á€¬á€„á€ºá€¸á€™á€šá€º
""")
import numpy as np
# Create a new figure before plotting
fig, ax = plt.subplots()
# Plot histogram
counts, bins, _ = ax.hist(df.Age.dropna(), bins=20, color="yellow", edgecolor="red", label="Age bins")
# Calculate bin centers and plot line
bin_centers = (bins[:-1] + bins[1:]) / 2
ax.plot(bin_centers, counts, marker="o", color="r", label="Age Distribution")
# Customizing the plot
ax.set_xticks(np.arange(0, 84, 4))
ax.set_title("Age Distribution")
ax.set_xlabel("Age")
ax.set_ylabel("Frequency")
ax.legend()
st.pyplot(fig) # Show the plot in Streamlit
st.text("-------------------------------------------------------------------------------")  # add a line
#--------------------------------------------------------------------------------------#
st.markdown("""
#### ğŸ§  á€’á€® Dashboard á€œá€±á€¸á€€ á€á€¬á€™á€”á€º Python á€œá€±á€·á€€á€»á€„á€·á€ºá€á€”á€ºá€¸á€‘á€€á€ºá€•á€­á€¯á€•á€¼á€®á€¸  
Data Analysis á€”á€²á€· Visualization á€€á€­á€¯ á€á€€á€šá€ºá€á€™á€ºá€¸á€á€¯á€¶á€¸á€–á€­á€¯á€·á€¡á€á€½á€€á€º á€¡á€‘á€±á€¬á€€á€ºá€¡á€€á€°á€–á€¼á€…á€ºá€•á€«á€á€šá€ºá‹  

ğŸ“Œ á€€á€­á€¯á€šá€ºá€•á€­á€¯á€„á€ºá€…á€­á€á€ºá€€á€°á€¸á€á€½á€±á€”á€²á€· dataset á€¡á€á€…á€ºá€á€½á€±á€”á€²á€· á€•á€¼á€”á€ºá€œá€¯á€•á€ºá€€á€¼á€Šá€·á€ºá€á€¬á€€  
á€”á€±á€¬á€€á€ºá€‘á€•á€ºá€¡á€á€…á€ºá€á€½á€±á€€á€­á€¯ á€á€„á€ºá€šá€°á€–á€­á€¯á€·á€¡á€á€½á€€á€º á€¡á€›á€™á€ºá€¸á€¡á€›á€±á€¸á€€á€¼á€®á€¸á€•á€«á€á€šá€ºá‹  

ğŸ“¥ á€á€„á€ºá€€á€­á€¯á€šá€ºá€á€­á€¯á€„á€º á€œá€±á€·á€€á€»á€„á€ºá€·á€–á€­á€¯á€·:  
â¡ï¸ [Download Titanic.csv](https://raw.githubusercontent.com/arkarpro/titanic-eda-dashboard/main/Titanic.csv)  
â¡ï¸ [Download app.py](https://raw.githubusercontent.com/arkarpro/titanic-eda-dashboard/main/app.py)  

ğŸ¤ á€¡á€á€°á€á€€á€½ á€á€„á€ºá€šá€°á€€á€¼á€›á€¡á€±á€¬á€„á€º â€“  
â¡ï¸ [GitHub - Arkar](https://github.com/arkarpro)  
â¡ï¸ [LinkedIn - Arkar](https://www.linkedin.com/in/arkar-linn-datapro/)
""")
