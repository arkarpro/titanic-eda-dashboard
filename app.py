import pandas as pd
import streamlit as st
import matplotlib.pyplot as plt
#--------------------------------------------------------------------------------------#
# Load CSV with caching and loading spinner
@st.cache_data
def load_data():
    return pd.read_csv("https://raw.githubusercontent.com/arkarpro/titanic-eda-dashboard/main/Titanic.csv")

with st.spinner("ğŸ”„ Loading data... Please wait."):
    df = load_data()
#--------------------------------------------------------------------------------------#
# Dashboard Title
st.markdown(
    "<h1 style='color:blue; font-size: 36px; text-align: left;'>Titanic EDA Dashboard</h1>", 
    unsafe_allow_html=True
)
st.info("Titanic EDA Dashboard á€á€Šá€º á€á€„á€ºá€€á€¼á€¬á€¸á€™á€¾á€¯á€†á€­á€¯á€„á€ºá€›á€¬ á€¡á€œá€­á€¯á€€á€º á€œá€±á€·á€€á€»á€„á€ºá€·á€á€±á€¬á€–á€­á€¯á€„á€ºá€–á€¼á€…á€ºá€•á€«á€á€–á€¼á€„á€ºá€· á€¡á€á€¼á€±á€á€¶á€á€„á€ºá€€á€¼á€¬á€¸á€™á€¾á€¯á€™á€»á€¬á€¸á€€á€­á€¯ á€œá€±á€·á€œá€¬á€á€„á€ºá€€á€¼á€¬á€¸á€á€¼á€„á€ºá€¸á€€á€­á€¯ á€œá€€á€ºá€á€½á€±á€·á€™á€»á€¾á€á€±á€á€±á€¬ á€œá€±á€·á€€á€»á€„á€ºá€·á€á€”á€ºá€¸á€á€…á€ºá€á€¯á€á€¬á€–á€¼á€…á€ºá€•á€«á€á€Šá€ºá‹")
st.markdown("""
    - **á€šá€á€¯á€œá€±á€·á€€á€»á€„á€·á€ºá€á€”á€ºá€¸á€™á€¾á€¬** á€á€›á€®á€¸á€á€Šá€ºá€™á€»á€¬á€¸á *á€¡á€™á€»á€­á€¯á€¸á€¡á€…á€¬á€¸*áŠ *á€¡á€á€€á€ºá€¡á€¯á€•á€ºá€…á€¯* á€”á€¾á€„á€·á€º *á€¡á€á€€á€ºá€›á€¾á€„á€º/á€á€±á€†á€¯á€¶á€¸á€™á€¾á€¯* á€¡á€á€¼á€±á€¡á€”á€±á€™á€»á€¬á€¸á€€á€­á€¯ á€á€¯á€¶á€¸á€á€•á€ºá€á€½á€¬á€¸á€™á€¾á€¬ á€–á€¼á€…á€ºá€•á€«á€á€šá€ºá‹
    - **á€™á€¾á€á€ºá€á€»á€€á€ºá‹ á‹** á€šá€á€¯á€œá€±á€·á€€á€»á€„á€ºá€·á€á€”á€ºá€¸á€€á€­á€¯ á€á€„á€ºá€€á€¼á€¬á€¸á€™á€¾á€¯ á€¡á€á€”á€ºá€¸á€¡á€œá€­á€¯á€€á€º á€á€†á€„á€ºá€·á€…á€® update á€•á€¼á€¯á€œá€¯á€•á€ºá€á€½á€¬á€¸á€™á€Šá€ºá€–á€¼á€…á€ºá€•á€«á€á€Šá€ºá‹
""")

st.info("Titanic á€á€„á€ºá€¹á€˜á€±á€¬á€€á€¼á€®á€¸ á€á€›á€®á€¸á€á€Šá€ºá€¡á€á€»á€€á€ºá€¡á€œá€€á€ºá€™á€»á€¬á€¸")
st.markdown("""
    - á€á€›á€®á€¸á€á€Šá€º á€…á€¯á€…á€¯á€•á€±á€«á€„á€ºá€¸ **áˆá‰á** á€¦á€¸ á€•á€«á€á€„á€ºá€á€Šá€ºá‹
    - **á€¡á€™á€»á€­á€¯á€¸á€á€¬á€¸ á…á‡á‡** á€¦á€¸á€”á€¾á€„á€·á€º **á€¡á€™á€»á€­á€¯á€¸á€á€™á€®á€¸ áƒáá„** á€¦á€¸ á€•á€«á€á€„á€ºá€á€Šá€ºá‹
    - á€šá€á€¯á€œá€±á€·á€€á€»á€„á€·á€ºá€á€”á€ºá€¸á€á€½á€„á€ºáŠ 
        - á€¡á€á€€á€ºá€¡á€¯á€•á€ºá€…á€¯
        - á€…á€®á€¸á€”á€„á€ºá€¸á€œá€­á€¯á€€á€ºá€•á€«á€œá€¬á€á€Šá€ºá€· á€¡á€á€”á€ºá€¸ (P class)
        - á€€á€»á€¬á€¸/á€™
        - á€›á€¾á€„á€ºá€á€”á€º/á€á€±á€†á€¯á€¶á€¸á€™á€¾á€¯á€™á€»á€¬á€¸
    á€€á€­á€¯ á€…á€¯á€…á€Šá€ºá€¸á€á€¯á€¶á€¸á€á€•á€ºá€á€½á€¬á€¸á€€á€¼á€™á€¾á€¬ á€–á€¼á€…á€ºá€•á€«á€á€šá€ºá‹
""")

#--------------------------------------------------------------------------------------#
# add one blank line here
st.text("")  # Blank line
st.text("")  # Blank line
st.text("")  # Blank line
#--------------------------------------------------------------------------------------#
total_passengers_sex= df.Sex.value_counts() # prepare passenger table
st.markdown("#### Total Passengers by Gender") #show subtitle
st.markdown("""
    ##### ğŸ’¡ Idea  
    - á€á€›á€®á€¸á€á€½á€¬á€¸ á€¡á€™á€»á€­á€¯á€¸á€á€¬á€¸áŠ á€¡á€™á€»á€­á€¯á€¸á€á€™á€®á€¸ á€¡á€›á€±á€¡á€á€½á€€á€ºá€€á€­á€¯ á€¡á€á€»á€€á€ºá€¡á€œá€€á€ºá€¡á€¬á€¸á€–á€¼á€„á€ºá€· á€’á€±á€«á€„á€ºá€¸á€œá€¯á€á€ºá€á€»á€”á€­á€¯á€„á€ºá€›á€”á€º á€˜á€šá€ºá€˜á€€á€ºá€á€½á€„á€º á€‡á€šá€¬á€¸á€–á€¼á€„á€ºá€· á€–á€±á€¬á€ºá€•á€¼á€‘á€¬á€¸á€•á€¼á€®á€¸á€á€±á€¬á€·áŠ  
    - á€¡á€á€»á€€á€ºá€¡á€œá€€á€ºá€€á€­á€¯ á€¡á€œá€½á€šá€ºá€™á€¼á€„á€ºá€á€¬á€…á€±á€›á€”á€º á€Šá€¬á€˜á€€á€ºá€á€½á€„á€º Bar Chart á€–á€¼á€„á€ºá€·â€‹á€–á€±á€¬á€ºá€•á€¼á€€á€¼á€™á€šá€ºá‹
""")
st.text("")  # Blank line

col01, col02 = st.columns(2) # to defind columns
with col01:
    st.markdown("**Count of Passengers**") #show subtitle
    st.dataframe(total_passengers_sex, height=100, width=250) # Show Total Passengers
with col02: # Bar chart in right size
    st.markdown("**Bar Chart**")
    fig, ax = plt.subplots(figsize=(1, 1), dpi=200)  # High DPI for clarity
    ax.bar(total_passengers_sex.index, total_passengers_sex.values, color=["skyblue", "salmon"])
    ax.set_title("Total Passengers by Gender", fontsize=6)
    ax.set_xlabel("Gender", fontsize=5)
    ax.set_ylabel("Total", fontsize=5)
    ax.tick_params(axis='both', which='both', length=0, labelsize=4)
    ax.spines["top"].set_visible(False)     # á€¡á€•á€±á€«á€ºá€˜á€±á€¬á€„á€ºá€–á€»á€±á€¬á€€á€º
    ax.spines["right"].set_visible(False)   # á€Šá€¬á€˜á€±á€¬á€„á€ºá€–á€»á€±á€¬á€€á€º
    ax.spines["bottom"].set_visible(False)  # á€¡á€±á€¬á€€á€ºá€˜á€±á€¬á€„á€ºá€–á€»á€±á€¬á€€á€º
    ax.spines["left"].set_visible(False)    # á€˜á€šá€ºá€˜á€±á€¬á€„á€ºá€–á€»á€±á€¬á€€á€º
    st.pyplot(fig)        # Show in Streamlit
#--------------------------------------------------------------------------------------#
st.text("-------------------------------------------------------------------------------")  # add a line
st.text("")  # Blank line
st.text("")  # Blank line
#--------------------------------------------------------------------------------------#
survived_status = df['Survived'].value_counts() # Prepare data

# Subtitle
st.markdown("#### Survived and Not-Survived Passengers")
st.markdown("""
    ##### ğŸ’¡ Idea  
    - á€¡á€á€€á€ºá€›á€¾á€„á€ºá€á€”á€ºá€€á€»á€”á€ºá€›á€…á€ºá€á€° á€…á€¬á€›á€„á€ºá€¸á€€á€­á€¯ á€€á€»á€¬á€¸áŠá€™ á€¡á€œá€­á€¯á€€á€ºá€–á€±á€¬á€ºá€•á€¼á€á€¼á€„á€ºá€¸á€–á€¼á€„á€ºá€· á€¡á€œá€½á€šá€ºá€á€€á€°á€”á€¾á€­á€¯á€„á€ºá€¸á€šá€¾á€‰á€ºá€”á€­á€¯á€„á€ºá€”á€­á€¯á€„á€ºá€¡á€±á€¬á€„á€ºá€•á€¼á€„á€ºá€†á€„á€ºá€™á€šá€ºá‹ 
    - á€’á€®á€á€…á€ºá€á€« á€¡á€á€¼á€±á€á€¶ Pie chart á€œá€±á€¸á€€á€­á€¯ á€›á€­á€¯á€¸á€›á€¾á€„á€ºá€¸á€…á€½á€¬á€‘á€Šá€ºá€·á€™á€šá€ºá‹
""")
# Columns
col1, col2 = st.columns(2)
# Styled box (left side)
with col1:
    st.markdown("** Count Table**")
    st.dataframe(survived_status, height=100, width=250)  # small height, just enough for 2 rows
# Pie chart (right side)
with col2:
    st.markdown("** Pie Chart**")
    fig, ax = plt.subplots(figsize=(1.5, 1.5), dpi=200)  # Higher DPI for clear labels
    ax.pie(survived_status, labels=["Not-Survived", "Survived"], autopct="%0.2f%%", shadow=True,
           colors=["red", "green"], textprops={'fontsize': 6})  # Clearer pie labels
    st.pyplot(fig)
st.text("-------------------------------------------------------------------------------")  # add a line
#--------------------------------------------------------------------------------------#
st.markdown("#### á€”á€±á€¬á€€á€ºá€›á€€á€ºá€™á€»á€¬á€¸á€™á€¾á€¬ á€†á€€á€ºá€œá€€á€º á€œá€±á€·á€œá€¬á€€á€¼á€›á€„á€ºá€¸ á€¡á€†á€„á€ºá€·á€™á€¼á€¾á€„á€ºá€·á€€á€¼á€™á€šá€ºá€”á€±á€¬á€º Bye!")
